<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Interest Prediction</title>
    <!--Will need to change below-->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="resources/css/predictions.css">

</head>
<body>
    <div class="header">
        <h3>Loan Insight</h3>
        <a href="index.html">Home</a>
    </div>

    <div class="container">
        <h2>User Dashboard</h2>
        <p>Welcome to the Loan Insight Prediction Portal. Use our tools to explore loan interest chances.</p>
        <div class="input-boxes">

            <!-- First Name -->
            <div class="input-box">
                <label for="firstName">First Name</label>
                <input type="text" id="firstName" placeholder="Enter your first name">
            </div>

            <!-- Last Name -->
            <div class="input-box">
                <label for="lastName">Last Name</label>
                <input type="text" id="lastName" placeholder="Enter your last name">
            </div>

            <!-- Credit Score -->
            <!-- <div class="input-box">
                <label for="creditScore">Credit Score</label>
                <input type="number" id="creditScore" placeholder="Enter your credit score">
            </div> -->

            <!-- 1. Loan Amount -->
            <div class="input-box">
                <label for="loanAmount">Loan Amount</label>
                <input type="number" id="loanAmount" placeholder="Enter loan amount">
            </div>

            <!-- 4. Loan Term -->
            <div class="input-box">
                <label for="loanTerm">Loan Term (months)</label>
                <input type="number" id="loanTerm" placeholder="Enter loan term in months">
            </div>

            <div class="input-box">
                <label for="co-applicant_age">Co-Applicant age</label>
                <input type="number" id="co-applicant_age" placeholder="Enter Co-Applicant age">
            </div>
            
            <!-- 14. Purchaser Type -->
            <div class="input-box">
                <label for="purchaserType">Purchaser Type</label>
                <select id="purchaserType">
                    <option value="">Select</option>
                    <option value="0">0 - Not originated/sold</option>
                    <option value="1">1 - Fannie Mae</option>
                    <option value="2">2 - Ginnie Mae</option>
                    <option value="3">3 - Freddie Mac</option>
                    <option value="4">4 - Farmer Mac</option>
                    <option value="5">5 - Private Securitization</option>
                    <option value="6">6 - Bank/Credit Union</option>
                    <option value="7">7 - Insurance Company</option>
                    <option value="8">8 - Affiliate Institution</option>
                    <option value="9">9 - Other</option>
                    <option value="10">10 - Not Applicable</option>
                </select>
            </div>

            <div class="input-box">
                <label for="loan_purpose">Loan purpose</label>
                <select id="loan_purpose">
                    <option value="">Select</option>
                    <option value="2">Home Improvement</option>
                    <option value="4">Other Purpose</option>
                    <option value="5">Construction</option>
                </select>
            </div>

            <div class="input-box">
                <label for="loan_type">Loan type</label>
                <select id="loan_type">
                    <option value="">Select</option>
                    <option value="2">FHA-insured loan</option>
                    <option value="3">VA-guaranteed loan</option>
                </select>
            </div>

            <!-- 15. Applicant Credit Score Type -->
            <div class="input-box">
                <label for="applicantCreditScore">Applicant Credit Score Type</label>
                <select id="applicantCreditScore">
                    <option value="">Select</option>
                    <option value="1">1 - Equifax Beacon 5.0</option>
                    <option value="2">2 - Experian FICO</option>
                    <option value="3">3 - TransUnion FICO</option>
                    <option value="4">4 - VantageScore 2.0</option>
                    <option value="5">5 - VantageScore 3.0</option>
                    <option value="6">6 - Other</option>
                    <option value="7">7 - Not provided</option>
                    <option value="8">8 - Not applicable</option>
                </select>
            </div>

            <!-- 16. Co-Applicant Credit Score Type -->
            <div class="input-box">
                <label for="coApplicantCreditScore">Co-Applicant Credit Score Type</label>
                <select id="coApplicantCreditScore">
                    <option value="">Select</option>
                    <option value="1">1 - Equifax Beacon 5.0</option>
                    <option value="2">2 - Experian FICO</option>
                    <option value="3">3 - TransUnion FICO</option>
                    <option value="4">4 - VantageScore 2.0</option>
                    <option value="5">5 - VantageScore 3.0</option>
                    <option value="6">6 - Other</option>
                    <option value="7">7 - Not provided</option>
                    <option value="8">8 - Not applicable</option>
                </select>
            </div>

            <div class="input-box">
                <label for="lien_status">Lien Status</label>
                <select id="lien_status">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <!-- 17-27: All Yes/No Dropdowns -->

            <div class="input-box">
                <label for="negativeAmortization">Negative Amortization</label>
                <select id="negativeAmortization">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="interestOnly">Interest Only Payment</label>
                <select id="interestOnly">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="balloonPayment">Balloon Payment</label>
                <select id="balloonPayment">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="otherFeatures">Other Nonamortizing Features</label>
                <select id="otherFeatures">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="conforming_loan_limit_NC">Non Conforming Loan Limit</label>
                <select id="conforming_loan_limit_NC">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="applicantAge62">Applicant Age â‰¥ 62</label>
                <select id="applicantAge62">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="fhaLien">FHA: First Lien</label>
                <select id="fhaLien">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="vaLien">VA: First Lien</label>
                <select id="vaLien">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="vaSubordinateLien">VA: Subordinate Lien</label>
                <select id="vaSubordinateLien">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="derived_loan_product_type_Conventional:Subordinate Lien">Conventional: Subordinate Lien</label>
                <select id="derived_loan_product_type_Conventional:Subordinate Lien">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            
            <div class="input-box">
                <label for="occupancy_type_3">Non Owner Occupied property</label>
                <select id="occupancy_type_3">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="initially_payable_to_institution_3">Initially Payable to Institution</label>
                <select id="initially_payable_to_institution_3">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="manufactured_home_secured_property_type_2">Manufactured Home Secured Property</label>
                <select id="manufactured_home_secured_property_type_2">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="manufactured_home_land_property_interest_3">Manufactured Home Land Property</label>
                <select id="manufactured_home_land_property_interest_3">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="submission_of_application_3">Loan Application submitted via third party?</label>
                <select id="submission_of_application_3">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="openEndCredit">Open-end Line of Credit</label>
                <select id="openEndCredit">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="business_or_commercial_purpose">Loan is for Business/Commercial Purpose?</label>
                <select id="business_or_commercial_purpose">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <div class="input-box">
                <label for="reverseMortgage">Reverse Mortgage</label>
                <select id="reverseMortgage">
                    <option value="">Select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
        </div>

        <!-- Submit Button -->
        <button class="submit-btn">Submit</button>
    </div>
    
    <script>
    window.addEventListener('DOMContentLoaded', () => {
        document.querySelector('.submit-btn').addEventListener('click', async () => {
            console.log("Submitting to backend...");
            const data = {
                loan_amount: parseFloat(document.getElementById('loanAmount').value || 0),
                loan_term: parseFloat(document.getElementById('loanTerm').value || 0),
                loan_purpose_2: document.getElementById('loan_purpose').value === "2" ? 1 : 0,
                loan_purpose_4: document.getElementById('loan_purpose').value === "4" ? 1 : 0,
                loan_purpose_5: document.getElementById('loan_purpose').value === "5" ? 1 : 0,
                loan_type_2: document.getElementById('loan_type').value === "2" ? 1 : 0,
                loan_type_3: document.getElementById('loan_type').value === "3" ? 1 : 0,
                lien_status_2: parseInt(document.getElementById('lien_status').value || 0),
                negative_amortization: parseInt(document.getElementById('negativeAmortization').value || 0),
                interest_only_payment: parseInt(document.getElementById('interestOnly').value || 0),
                balloon_payment: parseInt(document.getElementById('balloonPayment').value || 0),
                other_nonamortizing_features: parseInt(document.getElementById('otherFeatures').value || 0),
                conforming_loan_limit_NC: parseInt(document.getElementById('conforming_loan_limit_NC').value || 0),
                ['derived_loan_product_type_Conventional:Subordinate Lien']: parseInt(document.getElementById('derived_loan_product_type_Conventional:Subordinate Lien').value || 0),
                ['derived_loan_product_type_FHA:First Lien']: parseInt(document.getElementById('fhaLien').value || 0),
                ['derived_loan_product_type_VA:First Lien']: parseInt(document.getElementById('vaLien').value || 0),
                ['derived_loan_product_type_VA:Subordinate Lien']: parseInt(document.getElementById('vaSubordinateLien').value || 0),
                applicant_credit_score_type: parseInt(document.getElementById('applicantCreditScore').value || 0),
                ['co-applicant_credit_score_type']: parseInt(document.getElementById('coApplicantCreditScore').value || 0),
                ['co-applicant_age']: parseInt(document.getElementById('co-applicant_age').value || 0),
                applicant_age_above_62: parseInt(document.getElementById('applicantAge62').value || 0),
                occupancy_type_3: parseInt(document.getElementById('occupancy_type_3').value || 0),
                manufactured_home_secured_property_type_2: parseInt(document.getElementById('manufactured_home_secured_property_type_2').value || 0),
                manufactured_home_land_property_interest_3: parseInt(document.getElementById('manufactured_home_land_property_interest_3').value || 0),
                submission_of_application_3: parseInt(document.getElementById('submission_of_application_3').value || 0),
                initially_payable_to_institution_3: parseInt(document.getElementById('initially_payable_to_institution_3').value || 0),
                purchaser_type: parseInt(document.getElementById('purchaserType').value || 0),
                business_or_commercial_purpose: parseInt(document.getElementById('business_or_commercial_purpose').value || 0),
                ['open-end_line_of_credit']: parseInt(document.getElementById('openEndCredit').value || 0),
                reverse_mortgage: parseInt(document.getElementById('reverseMortgage').value || 0)
            };
        
            try {
                const res = await axios.post('http://localhost:5000/predict_interest_rate', data);
                alert(`Predicted Interest Rate: ${res.data.predicted_interest_rate}`);
            } catch (err) {
                console.error("Error occurred:", err);
                alert("An error occurred. See browser console.");
            }
        });
    });
        </script>

</body>
</html>
